---
import Base from "@/layouts/Base.astro";
import { getSinglePage } from "@/lib/contentParser.astro";
import PostSingle from "@/layouts/PostSingle.astro";

// For SSR mode, we need to fetch the data on each request
const { single } = Astro.params;
const posts = await getSinglePage("personal-finance");
const post = posts.find((p) => p.id === single);

// Handle 404 if post not found
if (!post) {
  return Astro.redirect("/404");
}

const { title, meta_title, description, image, date } = post.data;
---

<Base
  title={title}
  meta_title={meta_title}
  description={description}
  image={image}
  datePublished={date ? new Date(date).toISOString() : undefined}
  dateModified={date ? new Date(date).toISOString() : undefined}
  pageType="article"
>
  <PostSingle post={post} />
</Base>
